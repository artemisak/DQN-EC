\documentclass{article}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{xspace}
\usepackage{booktabs}

% Custom commands for clarity
\newcommand{\dalgg}{\textsc{Dalgg}\xspace}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}

\begin{document}

\begin{algorithm}
\caption{Density-Adaptive Local Geometric Graph (\dalgg)}
\label{alg:dalgg}
\begin{algorithmic}[1]
\REQUIRE Point cloud $\mathcal{P} = \{p_1, p_2, \ldots, p_n\} \subset \R^d$
\REQUIRE Density parameter $k \in \N$ (default: 10)
\REQUIRE Density scaling factor $\alpha \in \R^+$ (default: 1.5)
\REQUIRE Gabriel threshold $\beta \in (0, 1]$ (default: 0.7)
\ENSURE Edge set $E \subseteq \mathcal{P} \times \mathcal{P}$

\STATE Construct KD-tree $\mathcal{T}$ from $\mathcal{P}$ \COMMENT{$O(n \log n)$}
\STATE Initialize $E \leftarrow \emptyset$

\STATE \COMMENT{Compute local densities for all points}
\FOR{$i = 1$ to $n$}
    \STATE $\mathcal{N}_i^k \leftarrow k\text{-NN}(p_i, \mathcal{T}) \setminus \{p_i\}$ 
    \STATE $\rho_i \leftarrow \left(\frac{1}{k}\sum_{p_j \in \mathcal{N}_i^k} \|p_i - p_j\| + \epsilon\right)^{-1}$
\ENDFOR

\STATE $\tilde{\rho} \leftarrow \text{median}(\{\rho_1, \ldots, \rho_n\})$

\STATE \COMMENT{Construct edges with density-adaptive neighborhoods}
\FOR{$i = 1$ to $n$}
    \STATE $k_i \leftarrow \max\left(3, \min\left(2k, \left\lfloor k \cdot \left(\frac{\rho_i}{\tilde{\rho}}\right)^{\alpha} \right\rfloor\right)\right)$
    \STATE $\mathcal{N}_i \leftarrow k_i\text{-NN}(p_i, \mathcal{T}) \setminus \{p_i\}$
    
    \FOR{each $p_j \in \mathcal{N}_i$ where $j > i$} \COMMENT{Avoid duplicate edges}
        \IF{$\text{SatisfiesGabrielCriterion}(p_i, p_j, \mathcal{P}, \mathcal{T}, \beta)$}
            \STATE $E \leftarrow E \cup \{(p_i, p_j)\}$
        \ENDIF
    \ENDFOR
\ENDFOR

\RETURN $E$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{SatisfiesGabrielCriterion}
\label{alg:gabriel}
\begin{algorithmic}[1]
\REQUIRE Points $p_i, p_j \in \mathcal{P}$, point set $\mathcal{P}$, KD-tree $\mathcal{T}$, threshold $\beta$
\ENSURE \texttt{true} if $(p_i, p_j)$ satisfies $\beta$-Gabriel criterion

\STATE $d_{ij} \leftarrow \|p_i - p_j\|$
\STATE $\mathcal{C} \leftarrow \text{RangeQuery}(\mathcal{T}, p_i, \beta \cdot d_{ij})$ \COMMENT{Points within radius}

\FOR{each $p_k \in \mathcal{C} \setminus \{p_i, p_j\}$}
    \IF{$\|p_k - p_j\| < \beta \cdot d_{ij}$}
        \RETURN \texttt{false} \COMMENT{$p_k$ violates criterion}
    \ENDIF
\ENDFOR

\RETURN \texttt{true}
\end{algorithmic}
\end{algorithm}

% Mathematical notation and definitions
\section*{Definitions}

Let $\mathcal{P} = \{p_1, \ldots, p_n\} \subset \R^d$ be a point cloud. The \dalgg algorithm constructs a graph $G = (\mathcal{P}, E)$ where:

\begin{itemize}
    \item The \textbf{local density} at point $p_i$ is defined as:
    \[
    \rho_i = \frac{1}{\bar{d}_i + \epsilon}, \quad \text{where} \quad \bar{d}_i = \frac{1}{k}\sum_{p_j \in k\text{-NN}(p_i)} \|p_i - p_j\|
    \]
    
    \item The \textbf{adaptive neighborhood size} for point $p_i$ is:
    \[
    k_i = \max\left(3, \min\left(2k, \left\lfloor k \cdot \left(\frac{\rho_i}{\tilde{\rho}}\right)^{\alpha} \right\rfloor\right)\right)
    \]
    where $\tilde{\rho}$ is the median density and $\alpha$ controls adaptation strength.
    
    \item An edge $(p_i, p_j)$ is included if it satisfies the \textbf{$\beta$-Gabriel criterion}:
    \[
    \nexists p_k \in \mathcal{P} : \|p_k - p_i\| < \beta \|p_i - p_j\| \wedge \|p_k - p_j\| < \beta \|p_i - p_j\|
    \]
\end{itemize}

\section*{Complexity}

The algorithm runs in $O(n \log n + nk^2)$ time, where $n = |\mathcal{P}|$ and $k$ is the density parameter. Since $k \ll n$ in practice, the effective complexity is $O(n \log n)$.

\end{document}